# Define intervals and corresponding frequencies
intervals <- data.frame(
  lower = c(1, 5, 15, 20, 50, 80),
  upper = c(5, 15, 20, 50, 80, 110),
  frequency = c(200, 450, 300, 1500, 700, 44)
)

# Compute cumulative frequency
intervals$cum_frequency <- cumsum(intervals$frequency)

# Total frequency (N)
N <- sum(intervals$frequency)

# Median class: find the class where cumulative frequency >= N / 2
median_class_index <- which(intervals$cum_frequency >= N / 2)[1]

# Extract values for the median class
L <- intervals$lower[median_class_index] # Lower boundary of the median class
F <- ifelse(median_class_index > 1, intervals$cum_frequency[median_class_index - 1], 0) # Cumulative frequency before median class
f <- intervals$frequency[median_class_index] # Frequency of the median class
h <- intervals$upper[median_class_index] - intervals$lower[median_class_index] # Class width of the median class

# Compute the median
median_value <- L + (((N / 2) - F) / f) * h

# Output the median value
median_value
